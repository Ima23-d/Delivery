<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PedidoF√°cil - Entregador</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            min-height: 100vh; display: flex; align-items: center; justify-content: center; }
        
        .container { background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 100%; max-width: 400px; overflow: hidden; }
        
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; 
            padding: 30px; text-align: center; }
        .logo { font-size: 2.5rem; margin-bottom: 10px; }
        .title { font-size: 1.5rem; font-weight: 600; }
        .subtitle { opacity: 0.9; font-size: 0.9rem; }
        
        .tabs { display: flex; background: #f8f9fa; }
        .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; transition: all 0.3s ease;
            border-bottom: 3px solid transparent; }
        .tab.active { background: white; border-bottom-color: #667eea; color: #667eea; font-weight: 600; }
        .tab:hover:not(.active) { background: #e9ecef; }
        
        .form-container { padding: 30px; }
        .form { display: none; }
        .form.active { display: block; }
        
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; margin-bottom: 8px; color: #333; font-weight: 600; }
        .form-input { width: 100%; padding: 15px; border: 2px solid #e1e5e9; border-radius: 10px;
            font-size: 16px; transition: border-color 0.3s ease; }
        .form-input:focus { outline: none; border-color: #667eea; }
        
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        .submit-btn { width: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; border: none; padding: 15px; border-radius: 10px; font-size: 16px;
            font-weight: 600; cursor: pointer; transition: transform 0.2s ease; }
        .submit-btn:hover { transform: translateY(-2px); }
        .submit-btn:disabled { opacity: 0.7; cursor: not-allowed; transform: none; }
        
        .message { padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center; }
        .message.success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .message.error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        
        .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #ffffff;
            border-radius: 50%; border-top-color: transparent; animation: spin 1s ease-in-out infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .footer { text-align: center; padding: 20px; color: #666; font-size: 0.9rem; }
        .footer a { color: #667eea; text-decoration: none; }
        
        @media (max-width: 480px) { .container { margin: 20px; border-radius: 15px; }
            .form-row { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">üöö</div>
            <div class="title">PedidoF√°cil</div>
            <div class="subtitle">√Årea do Entregador</div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="mudarTab('login')">üîë Login</div>
            <div class="tab" onclick="mudarTab('cadastro')">üìù Cadastro</div>
        </div>

        <div class="form-container">
            <!-- Formul√°rio de Login -->
            <form class="form active" id="login-form">
                <div class="form-group">
                    <label class="form-label" for="login-email">E-mail</label>
                    <input type="email" class="form-input" id="login-email" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="login-senha">Senha</label>
                    <input type="password" class="form-input" id="login-senha" required>
                </div>
                
                <button type="submit" class="submit-btn" id="login-btn">
                    <span class="btn-text">üöö Entrar</span>
                </button>
            </form>

            <!-- Formul√°rio de Cadastro -->
            <form class="form" id="cadastro-form">
                <div class="form-group">
                    <label class="form-label" for="cadastro-nome">Nome Completo</label>
                    <input type="text" class="form-input" id="cadastro-nome" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="cadastro-email">E-mail</label>
                    <input type="email" class="form-input" id="cadastro-email" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="cadastro-telefone">Telefone</label>
                        <input type="tel" class="form-input" id="cadastro-telefone" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="cadastro-cpf">CPF</label>
                        <input type="text" class="form-input" id="cadastro-cpf" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="cadastro-veiculo">Tipo de Ve√≠culo</label>
                    <select class="form-input" id="cadastro-veiculo" required>
                        <option value="">Selecione...</option>
                        <option value="moto">Moto</option>
                        <option value="bicicleta">Bicicleta</option>
                        <option value="carro">Carro</option>
                        <option value="patinete">Patinete El√©trico</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="cadastro-placa">Placa (se aplic√°vel)</label>
                    <input type="text" class="form-input" id="cadastro-placa" placeholder="ABC-1234">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="cadastro-endereco">Endere√ßo</label>
                    <input type="text" class="form-input" id="cadastro-endereco" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="cadastro-senha">Senha</label>
                        <input type="password" class="form-input" id="cadastro-senha" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="cadastro-confirmar-senha">Confirmar Senha</label>
                        <input type="password" class="form-input" id="cadastro-confirmar-senha" required>
                    </div>
                </div>
                
                <button type="submit" class="submit-btn" id="cadastro-btn">
                    <span class="btn-text">üìù Criar Conta</span>
                </button>
            </form>
        </div>

        <div class="footer">
            <p>J√° tem uma conta? <a href="#" onclick="mudarTab('login')">Fa√ßa login</a></p>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "sua-api-key", authDomain: "seu-projeto.firebaseapp.com",
            projectId: "seu-projeto", storageBucket: "seu-projeto.appspot.com",
            messagingSenderId: "123456789", appId: "seu-app-id"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let currentTab = 'login';

        document.addEventListener('DOMContentLoaded', function() {
            configurarFormularios();
        });

        function mudarTab(tab) {
            currentTab = tab;
            
            // Atualizar tabs
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // Atualizar formul√°rios
            document.querySelectorAll('.form').forEach(f => f.classList.remove('active'));
            document.getElementById(`${tab}-form`).classList.add('active');
            
            // Atualizar footer
            const footer = document.querySelector('.footer p');
            if (tab === 'login') {
                footer.innerHTML = 'N√£o tem uma conta? <a href="#" onclick="mudarTab(\'cadastro\')">Cadastre-se</a>';
            } else {
                footer.innerHTML = 'J√° tem uma conta? <a href="#" onclick="mudarTab(\'login\')">Fa√ßa login</a>';
            }
        }

        function configurarFormularios() {
            document.getElementById('login-form').addEventListener('submit', fazerLogin);
            document.getElementById('cadastro-form').addEventListener('submit', fazerCadastro);
        }

        async function fazerLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const senha = document.getElementById('login-senha').value;
            
            if (!email || !senha) {
                mostrarMensagem('Por favor, preencha todos os campos', 'error');
                return;
            }
            
            const btn = document.getElementById('login-btn');
            const btnText = btn.querySelector('.btn-text');
            
            btn.disabled = true;
            btnText.innerHTML = '<span class="loading"></span> Entrando...';
            
            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, senha);
                const user = userCredential.user;
                
                // Verificar se √© um entregador
                const userDoc = await db.collection('usuarios').doc(user.uid).get();
                if (userDoc.exists && userDoc.data().tipo === 'entregador') {
                    const userData = userDoc.data();
                    localStorage.setItem('user', JSON.stringify({
                        uid: user.uid,
                        email: user.email,
                        tipo: 'entregador',
                        nome: userData.nome,
                        telefone: userData.telefone,
                        endereco: userData.endereco,
                        veiculo: userData.veiculo,
                        placa: userData.placa,
                        cpf: userData.cpf
                    }));
                    
                    mostrarMensagem('Login realizado com sucesso! Redirecionando...', 'success');
                    setTimeout(() => {
                        window.location.href = 'home_entregador.html';
                    }, 1500);
                } else {
                    await auth.signOut();
                    mostrarMensagem('Esta conta n√£o √© de um entregador', 'error');
                }
            } catch (error) {
                console.error('Erro no login:', error);
                let mensagem = 'Erro ao fazer login';
                
                if (error.code === 'auth/user-not-found') {
                    mensagem = 'Usu√°rio n√£o encontrado';
                } else if (error.code === 'auth/wrong-password') {
                    mensagem = 'Senha incorreta';
                } else if (error.code === 'auth/invalid-email') {
                    mensagem = 'E-mail inv√°lido';
                }
                
                mostrarMensagem(mensagem, 'error');
            } finally {
                btn.disabled = false;
                btnText.innerHTML = 'üöö Entrar';
            }
        }

        async function fazerCadastro(event) {
            event.preventDefault();
            
            const nome = document.getElementById('cadastro-nome').value;
            const email = document.getElementById('cadastro-email').value;
            const telefone = document.getElementById('cadastro-telefone').value;
            const cpf = document.getElementById('cadastro-cpf').value;
            const veiculo = document.getElementById('cadastro-veiculo').value;
            const placa = document.getElementById('cadastro-placa').value;
            const endereco = document.getElementById('cadastro-endereco').value;
            const senha = document.getElementById('cadastro-senha').value;
            const confirmarSenha = document.getElementById('cadastro-confirmar-senha').value;
            
            // Valida√ß√µes
            if (!nome || !email || !telefone || !cpf || !veiculo || !endereco || !senha || !confirmarSenha) {
                mostrarMensagem('Por favor, preencha todos os campos obrigat√≥rios', 'error');
                return;
            }
            
            if (senha !== confirmarSenha) {
                mostrarMensagem('As senhas n√£o coincidem', 'error');
                return;
            }
            
            if (senha.length < 6) {
                mostrarMensagem('A senha deve ter pelo menos 6 caracteres', 'error');
                return;
            }
            
            if (veiculo === 'moto' || veiculo === 'carro') {
                if (!placa || placa.trim() === '') {
                    mostrarMensagem('Placa √© obrigat√≥ria para motos e carros', 'error');
                    return;
                }
            }
            
            const btn = document.getElementById('cadastro-btn');
            const btnText = btn.querySelector('.btn-text');
            
            btn.disabled = true;
            btnText.innerHTML = '<span class="loading"></span> Criando conta...';
            
            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, senha);
                const user = userCredential.user;
                
                // Salvar dados do usu√°rio
                await db.collection('usuarios').doc(user.uid).set({
                    nome: nome,
                    email: email,
                    telefone: telefone,
                    cpf: cpf,
                    veiculo: veiculo,
                    placa: placa,
                    endereco: endereco,
                    tipo: 'entregador',
                    dataCadastro: new Date(),
                    ativo: true,
                    disponivel: true,
                    avaliacao: 0,
                    totalAvaliacoes: 0,
                    totalEntregas: 0,
                    totalGanhos: 0
                });
                
                // Salvar dados do entregador
                await db.collection('entregadores').doc(user.uid).set({
                    id: user.uid,
                    nome: nome,
                    email: email,
                    telefone: telefone,
                    cpf: cpf,
                    veiculo: veiculo,
                    placa: placa,
                    endereco: endereco,
                    ativo: true,
                    disponivel: true,
                    avaliacao: 0,
                    totalAvaliacoes: 0,
                    totalEntregas: 0,
                    totalGanhos: 0,
                    dataCadastro: new Date()
                });
                
                // Salvar no localStorage
                localStorage.setItem('user', JSON.stringify({
                    uid: user.uid,
                    email: user.email,
                    tipo: 'entregador',
                    nome: nome,
                    telefone: telefone,
                    endereco: endereco,
                    veiculo: veiculo,
                    placa: placa,
                    cpf: cpf
                }));
                
                mostrarMensagem('Conta criada com sucesso! Redirecionando...', 'success');
                setTimeout(() => {
                    window.location.href = 'home_entregador.html';
                }, 1500);
                
            } catch (error) {
                console.error('Erro no cadastro:', error);
                let mensagem = 'Erro ao criar conta';
                
                if (error.code === 'auth/email-already-in-use') {
                    mensagem = 'Este e-mail j√° est√° em uso';
                } else if (error.code === 'auth/weak-password') {
                    mensagem = 'A senha √© muito fraca';
                } else if (error.code === 'auth/invalid-email') {
                    mensagem = 'E-mail inv√°lido';
                }
                
                mostrarMensagem(mensagem, 'error');
            } finally {
                btn.disabled = false;
                btnText.innerHTML = 'üìù Criar Conta';
            }
        }

        function mostrarMensagem(texto, tipo) {
            // Remover mensagens anteriores
            const mensagensAnteriores = document.querySelectorAll('.message');
            mensagensAnteriores.forEach(msg => msg.remove());
            
            const mensagem = document.createElement('div');
            mensagem.className = `message ${tipo}`;
            mensagem.textContent = texto;
            
            const formContainer = document.querySelector('.form-container');
            formContainer.insertBefore(mensagem, formContainer.firstChild);
            
            setTimeout(() => {
                if (mensagem.parentNode) {
                    mensagem.remove();
                }
            }, 5000);
        }
    </script>
</body>
</html>
